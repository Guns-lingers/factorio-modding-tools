# .github/workflows/issue-on-release.yml
name: "üìù Create feedback issue on release"

on:
  release:
    types: [published]      # —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ Publish release :contentReference[oaicite:2]{index=2}

permissions:
  contents: read           # —á—Ç–æ–±—ã —á–∏—Ç–∞—Ç—å —à–∞–±–ª–æ–Ω-—Ñ–∞–π–ª
  issues: write            # —á—Ç–æ–±—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å Issue :contentReference[oaicite:3]{index=3}

jobs:
  create-feedback-issue:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      # –†–µ–Ω–¥–µ—Ä–∏–º Markdown-—à–∞–±–ª–æ–Ω (–ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º .release.tag_name)
      - id: render
        uses: chuhlomin/render-template@v1
        with:
          template: .github/ISSUE_TEMPLATE/release-feedback.md
          vars: |
            release:
              tag_name: ${{ github.event.release.tag_name }}
          result_path: rendered-feedback.md   # –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ñ–∞–π–ª 

      - name: Verify rendered file
        run: |
          echo "=== rendered-feedback.md ==="
          cat rendered-feedback.md

      - name: Create release feedback issue
        uses: peter-evans/create-issue-from-file@v4
        with:
          content-filepath: rendered-feedback.md  # –ø–µ—Ä–µ–¥–∞—ë–º —É–∂–µ –≥–æ—Ç–æ–≤—ã–π Markdown
          title: "[Feedback][${{ github.event.release.tag_name }}]"
          labels: feedback,release
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
